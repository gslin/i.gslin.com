<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Minimal image hosting</title>
</head>
<body>
<h1>Minimal image hosting</h1>
<form action="/upload.php" method="post">
  <input type="hidden" name="csrf_token" value="%CSRF_TOKEN%"/>
  <input type="file" name="image" />
  <input type="submit"/>
</form>
<p>Select file to upload, or just copy &amp; paste image to here.</p>
<script>
<!--
document.addEventListener('paste', async ev => {
  const items = (ev.clipboardData || ev.originalEvent.clipboardData).items;
  for (const item of items) {
    if (item.type.indexOf('image') !== -1) {
      const file = item.getAsFile();
      console.debug(file);

      const f = new FormData();
      f.append('file', file);
      f.append('csrf_token', '%CSRF_TOKEN%');

      const res = await fetch('/upload.php', {
        body: f,
        method: 'POST',
      });

      const data = await res.json();
      document.location = data.images.png;
    }
  }
});
//-->
</script>
</body>
</html>
